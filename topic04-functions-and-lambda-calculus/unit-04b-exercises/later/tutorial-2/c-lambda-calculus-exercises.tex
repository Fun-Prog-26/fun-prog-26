\documentclass{article}
\usepackage[english]{babel}
\usepackage{fancyhdr}
\usepackage{enumitem}
\usepackage{listings}
\usepackage{tikz-qtree}
\usepackage{tikz-qtree-compat}
\usepackage{enumitem}
\usepackage[printsolution=false]{exercises}

\usepackage{color}
\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}


\lstset{frame=tb,
  language=Haskell,
  aboveskip=3mm,
  belowskip=3mm,
  showstringspaces=false,
  columns=flexible,
  basicstyle={\small\ttfamily},
  numbers=none,
  numberstyle=\tiny\color{gray},
  keywordstyle=\color{blue},
  commentstyle=\color{dkgreen},
  stringstyle=\color{mauve},
  breaklines=true,
  breakatwhitespace=true,
  tabsize=3
  }
\tikzset{edge from parent/.append style={->}}
 \newcommand\ExTitle{Lambda Calculus \ }

\newcommand\fullExTitle{Topic 04 - Tutorial Sheet-04\\ \ExTitle }

\newcommand\footerExTitle{\ExTitle -\  Exercises}

\pagestyle{fancy}
\fancyhead{} % clear all header fields
\renewcommand{\headrulewidth}{0pt} % no line in header area
\fancyfoot{} % clear all footer fields
\fancyfoot[LE,RO]{\thepage}           % page number in "outer" position of footer line
\fancyfoot[RE,LO]{\footerExTitle} % other info in "inner" position of footer line

\begin{document}
\begin{Huge}
	\begin{center}
	\fullExTitle
	\end{center}
\end{Huge}
\begin{exercise}
Keeping in mind  alpha equivalence,  choose an answer that is equivalent to the listed lambda term.
\begin{enumerate}
\item 
$\lambda xy.xz$
\begin{enumerate}
  \item 
  $\lambda xz.xz$
  \item
  $\lambda mn.mz$
  \item
  $\lambda z (\lambda.x.xz)$
  \end{enumerate}
  \item
  $\lambda xy.xxy$
  \begin{enumerate}
  \item 
  $\lambda mn.mnp$
   \item 
  $\lambda x.(\lambda y .xy)$
   \item 
  $\lambda a(\lambda b. aab)$
  \end{enumerate}
  \item
   $\lambda xyz. zx$
 \begin{enumerate}
  \item 
     $\lambda x.(\lambda y.(\lambda  z))$
   \item 
     $\lambda tos.st$
       \item 
     $\lambda mnp.mn$
  \end{enumerate}
   \end{enumerate}
 
 \end{exercise}
\begin{solution}
  \begin{enumerate}
    \item 
    $\lambda xy.xz$
   \begin{enumerate}[start=2]
      \item 
      $\lambda mn.mz$
   
    \end{enumerate}
      \item
      $\lambda xy.xxy$
      \begin{enumerate}[start=3]
       \item 
      $\lambda a(\lambda b. aab)$
      \end{enumerate}
      \item
       $\lambda xyz. zx$
       \begin{enumerate}[start=2]
       \item 
         $\lambda tos.st$
      \end{enumerate}
       \end{enumerate}
      \end{solution}

\begin{exercise}
Which (two or more) of the following are equivalent? 
\begin{enumerate}
     \item  \begin{lstlisting}
      mth x y z = x * y * z
    \end{lstlisting}

    \item  \begin{lstlisting}
      mth x y   = \z ->  x * y * z
    \end{lstlisting}

    \item  \begin{lstlisting}
      mth x    = \y -> \z ->  x * y * z
    \end{lstlisting}

    \item  \begin{lstlisting}
      mth     = \x -> \y -> \z ->  x * y * z
    \end{lstlisting}
  \end{enumerate}
\end{exercise}
\begin{solution}
  All are equivalent to each other
\end{solution}

\pagebreak
\begin{exercise}
  The type of \textbf{mth} (above) is  \begin{lstlisting}
    mth :: Num a=> a-> a-> a-> a
  \end{lstlisting}
  Write down the type of 
  \begin{lstlisting}
    mth 3
  \end{lstlisting} 
\end{exercise}
\begin{solution}
  \begin{lstlisting}
    mth 3 :: Num a => a-> a-> a
  \end{lstlisting} 
\end{solution}

\begin{exercise}

 
Rewrite, using Haskell and evaluate the following: 
\begin{enumerate}
\item $(\lambda x.x) 2$
\item $(\lambda x . (x*2) ) 4$
\item $ (\lambda x . (\lambda y. x*y) ) 3 \ 4$
\item$ (\lambda x . \lambda y .( if \ x < y \ then \ -1\  else\  if\  x\  ==\ y\  then\  0\  else\  1)) \ 3\  4$\\
(\textbf{\textit{Note:}} Use of if inside the lambda expression. )

\end{enumerate}
\end{exercise}
\begin{solution}
\begin{enumerate}
\item 2
\item 8
\item 12
\item -1
\end{enumerate}
\end{solution}
\begin{exercise}
Rewrite the $f$ function in the $where$ clause using anonymous lambda syntax 
\begin{lstlisting}
addOneIfOdd n = case odd n of 
    True -> f n 
    False -> n 
    where f n = n + 1
\end{lstlisting}
\end{exercise}
\begin{solution}
  \begin{lstlisting}
addOneIfOdd n = case odd n of 
    True -> (\x->x+1) n 
    False -> n 
    \end{lstlisting}
\end{solution}
\begin{exercise}
  Rewrite the following to use anonymous lambda syntax 
  \begin{lstlisting}
  addFive x y = (if x > y then x else y) + 5
\end{lstlisting}
\end{exercise}
\begin{solution}
  \begin{lstlisting}
   ( \x y-> if x > y then x+5 else y+5)  3 4   --applying it to 3 4
  \end{lstlisting}
\end{solution}
\begin{exercise}
Write a lambda version of the following functions: 
\begin{enumerate}
\item  \textbf{\textit{abs:}} which takes an Int and returns the non-negative value. \\
e.g. abs -1 = 1, abs 4 = 4.
\item \textbf{\textit{mymax:}} which takes two numbers and returns the larger of the two \\
\item \textbf{\textit{mymin:}} which takes two numbers and returns the smaller of the two \\
\end{enumerate}
\end{exercise}
\begin{solution}
  \begin{enumerate}
    \item \textbf{\textit{abs:}}
  \begin{lstlisting}
    (\x -> if x <0 then (-x) else x) (-4)   --applying it to (-4)
  \end{lstlisting}

  \item \textbf{\textit{mymax:}}
  \begin{lstlisting}
    (\x y -> if x>y then x else y) 14 5  --applying it to the arguments 14, 5
  \end{lstlisting}

  \item \textbf{\textit{mymin:}}
  \begin{lstlisting}
   (\x y -> if x<y then x else y)  14 5  --applying it to the arguments 14, 5
  \end{lstlisting}

\end{enumerate}
\end{solution}
\


% \newpage
% \begin{Huge}
% \begin{center}
% Solutions
% \end{center}
% \end{Huge}
% \shipoutAnswer

\end{document}
